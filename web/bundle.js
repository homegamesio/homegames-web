(()=>{var e={874:e=>{e.exports={name:"DUALSHOCK 4 Wireless Controller",buttons:{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5,LEFT_TRIGGER:6,RIGHT_TRIGGER:7,SELECT:8,START:9,STICK_CLICK_1:10,STICK_CLICK_2:11,DIRECTION_UP:12,DIRECTION_DOWN:13,DIRECTION_LEFT:14,DIRECTION_RIGHT:15,HOME:16},sticks:{STICK_1_X:0,STICK_1_Y:1,STICK_2_X:2,STICK_2_Y:3},deadzones:{STICK_1_X:.08,STICK_1_Y:.08,STICK_2_X:.08,STICK_2_Y:.08}}},645:(e,t,o)=>{const{Buttons:n,Sticks:s}=o(945),i=o(642),r=e=>{for(let t in i){const o=i[t];if(e.indexOf(o.name)>=0)return o}return null},a=(e,t,o)=>({value:e[t.buttons[o]]&&e[t.buttons[o]].value,pressed:!(!e[t.buttons[o]]||!e[t.buttons[o]].pressed)}),l=(e,t,o)=>{const n=e[t.sticks[o]];if(t.deadzones&&t.deadzones[o]){const e=t.deadzones[o];return Math.abs(n)<e?{value:0}:n<0?{value:(n+e)/(1-e)}:{value:(n-e)/(1-e)}}return{value:n}};e.exports={Homepad:class{constructor(){if(!window)throw new Error("No window available");this.indexToMapping={},this.initializeListeners()}initializeListeners(){window.addEventListener("gamepadconnected",(e=>{const t=e.gamepad,o=r(t.id);o&&(this.indexToMapping[t.index]=o)})),window.addEventListener("gamepaddisconnected",(e=>{delete this.indexToMapping[gamepad.index]}))}getGamepadState(e){const t=navigator.getGamepads()[e],o=this.indexToMapping[e],n=((e,t)=>{const o={};for(let n in t.buttons)o[n]=a(e,t,n);return o})(t.buttons,o),s=((e,t)=>{const o={};for(let n in t.sticks)o[n]=l(e,t,n);return o})(t.axes,o);return{buttons:n,sticks:s}}getGamepads(){if(!navigator||!navigator.getGamepads)throw new Error("No gamepad API available");return navigator.getGamepads().filter((e=>e)).map((e=>({index:e.index,mapping:r(e.id)}))).filter((e=>!!e.mapping)).map((e=>({state:this.getGamepadState(e.index),...e})))}},Buttons:n,Sticks:s}},945:()=>{},642:(e,t,o)=>{const n=o(874);e.exports={DUALSHOCK_4:n}},333:(e,t,o)=>{const{squish:n,unsquish:s}=o(983),{gameNode:i,GameNode:r}=o(532),a=(o(56),o(784)),l=o(367),h=o(797),d=o(27),c=o(137),u=o(298),{terrainGenerator:f}=o(907),p=o(830),g=o(226),y=o(972),w=o(526),x=o(636);e.exports={squish:n,unsquish:s,gameNode:i,subtypes:p,Game:l,ViewableGame:h,GameNode:r,Colors:a,Shapes:d,Squisher:g,ShapeUtils:c,ViewUtils:u,TerrainGenerator:f,GeometryUtils:w,Asset:y,Physics:x}},972:(e,t,o)=>{const n=o(737),{getAppDataPath:s}=o(290);e.exports=class{constructor(e,t=null){this.info=e,t&&(this.data=t),this.https=o(993),this.http=o(807),this.fs=o(386),this.crypto=o(115),this.path=o(737),this.process=o(284)}getConfigValue(e,t=undefined){const o=this.getConfig();let n=process.env[e]&&`${process.env[e]}`;if(void 0!==n)return"true"===n?n=!0:"false"===n&&(n=!1),console.log(`Using environment value: ${n} for key: ${e}`),n;if(void 0===o[e]&&void 0===t)throw new Error(`No value for ${e} found in config`);return void 0===o[e]&&void 0!==t?t:(console.log(`Found value ${o[e]} in config`),o[e])}getConfig(){if(this.cachedConfig)return this.cachedConfig;const e=[process.cwd(),o.c[o.s].filename,process.mainModule.filename,"/"];let t={};for(let o=0;o<e.length;o++)if(this.fs.existsSync(`${e[o]}/config.json`)){console.log(`Using config at ${e[o]}`),t=JSON.parse(this.fs.readFileSync(`${e[o]}/config.json`));break}return this.cachedConfig=t,t}getHash(e){const t=this.crypto.createHash("sha1");return t.update(e),t.digest("hex")}getFileLocation(){const e=this.getHash(this.info.id);return`${n.join(s(),"asset-cache")}/${e}`}existsLocallySync(){const e=this.getFileLocation(this.info.id);return fs.existsSync(e)}existsLocally(){return new Promise(((e,t)=>{this.data&&e(!0);const o=this.getFileLocation(this.info.id);this.fs.exists(o,(t=>{e(t&&o)}))}))}async downloadSync(e){const t=n.join(s(),"asset-cache");fs.existsSync(t)||fs.mkdirSync(t);const o=this.existsLocallySync(),i=this.getFileLocation(this.info.id);return o&&!e?(this.initialized=!0,i):(await downloadFileSync(this.info.id,t),this.initialized=!0,i)}download(e){const t=n.join(s(),"asset-cache");return this.fs.existsSync(t)||this.fs.mkdirSync(t),new Promise(((o,n)=>{this.existsLocally().then((s=>{s&&!e?(this.initialized=!0,o(s)):this.doDownload(this.info.id,t).then((e=>{this.initialized=!0,o(e)})).catch((e=>{n(e)}))}))}))}getData(){return new Promise(((e,t)=>{this.data?e(this.data):this.download().then((o=>{this.fs.readFile(o,((o,n)=>{o?t(o):e(n)}))})).catch((e=>{t(e)}))}))}doDownload(e,t){return new Promise(((o,n)=>{const s=this.getHash(e),i=`${t}/${s}`,r=this.fs.createWriteStream(i),a=this.https;r.on("close",(()=>{o(i)}));let l="";a.get(`https://assets.homegames.io/${e}`,(e=>{e.on("data",(e=>{l+=e,r.write(e)})),e.on("end",(()=>{r.end()}))})).on("error",(e=>{n(e)}))}))}}},55:(e,t,o)=>{const n=o(335),s=o(56),i=(e,t,o,i,r,a,l,h,d,c,u,f)=>{const p=new s(e,t,o,i,r,a,l,h,d,c,u,f);return n(p,p.onStateChange.bind(p))};e.exports={gameNode:i,BaseNode:class{constructor({color:e,onClick:t,coordinates2d:o,border:n,fill:s,textInfo:r,assetInfo:a,playerIds:l,effects:h,input:d,subtype:c,node:u,id:f}){this.node=u||i(e,t,o,n,s,r,a,l,h,d,c,f),this.id=this.node.id}showFor(e){const t=this.node.playerIds.indexOf(e),o=this.node.playerIds.indexOf(0);if(o>=0){const e=this.node.playerIds;e.splice(o,1),this.node.playerIds=e}if(t<0){const t=this.node.playerIds;t.push(e),this.node.playerIds=t}}hideFor(e){const t=this.node.playerIds.indexOf(e);if(t>=0){let e=this.node.playerIds;e.splice(t,1),0==e.length&&(e=[0]),this.node.playerIds=e}}addChild(e){this.node.addChild(e)}addChildren(...e){for(let t=0;t<e.length;t++)this.addChild(e[t])}getChildren(){return this.node.children}removeChild(e){this.node.removeChild(e)}addListener(e){this.node.addListener(e)}findChild(e){return this.findChildHelper(e,this)}findChildHelper(e,t,o=null){t.node.id===e&&(o=t);for(const n in t.node.children){if(o)return o;o=this.findChildHelper(e,t.node.children[n],o)}return o}clearChildren(e){this.node.clearChildren(e)}clone(){throw new Error("Clone not implemented")}free(){this.node.free()}}}},784:e=>{const t={ALMOST_BLACK:[16,16,16,255],ALMOST_WHITE:[238,238,238,255],ANTIQUE_WHITE:[250,235,215,255],AQUA:[188,212,230,255],AQUAMARINE:[127,255,212,255],BEIGE:[245,245,220,255],BIG_GRAY:[221,221,221,255],BLACK:[0,0,0,255],BLAY:[87,102,117,255],BLUE:[0,0,255,255],BLUE_WHISPER:[240,248,255,255],BLEEN:[19,51,55,255],BLOOD:[153,0,0,255],BOOGER:[186,218,85,255],BRIGHT_GRAY:[198,226,255,255],BRONZE:[227,151,17,255],BROWN:[145,97,11,255],CANDY_GREEN:[90,193,142,255],CANDY_PINK:[255,115,115,255],CANDY_RED:[246,84,106,255],CHARCOAL:[51,51,51,255],CALM_BLUE:[8,141,165,255],COOL_BLUE:[64,114,148,255],COOL_GREEN:[180,238,180,255],CORAL:[255,127,80,255],CORPORATE_BEIGE:[203,203,169,255],CREAM:[240,224,136,255],CREAMSICLE:[255,195,160,255],CYAN:[0,255,255,255],DARK_TURQUOISE:[0,206,209,255],DEEP_BLUE:[0,51,102,255],DEEP_PURPLE:[102,0,102,255],DEEP_RED:[139,0,0,255],DIM_GRAY:[105,105,105,255],DULL_BLUE:[192,214,228,255],EMERALD:[39,89,45,255],EVERGREEN:[6,85,53,255],FRIENDLY_BLUE:[70,132,153,255],FUCHSIA:[255,0,255,255],FUNNY_PURPLE:[128,0,128,255],GOLD:[255,215,0,255],GOLDMEMBER:[218,165,32,255],GRAY:[192,192,192,255],GREEN:[0,255,0,255],GUN_METAL_GRAY:[102,102,102,255],HARD_ORANGE_RED:[255,64,64,255],HARD_PINK:[247,52,122,255],HG_BLACK:[26,26,26,255],HG_BLUE:[148,210,230,255],HG_RED:[241,112,112,255],HG_YELLOW:[255,247,143,255],INTERIOR_RED:[255,102,102,255],INVITATION_BLUE:[104,151,187,255],KHAKI:[255,246,143,255],LAVENDER:[230,230,250,255],LIGHT_CORAL:[240,128,128,255],LIGHT_SEA_GREEN:[32,178,170,255],NAVY:[0,0,128,255],MAGENTA:[255,0,255,255],MAROON:[128,0,0,255],MEAN_SEA:[129,216,208,255],MERLOT:[66,4,32,255],MINT:[102,205,170,255],MUSTARD:[232,219,32,255],NEON_BOOGER:[204,255,0,255],NEON_PINK:[255,128,237,255],ORANGE:[255,165,0,255],ORANGE_RED:[255,69,0,255],PALE_TURQUOISE:[175,238,238,255],PEACH:[255,218,185,255],PERFUME_PINK:[255,228,225,255],PERRYWINKLE:[204,204,255,255],PINK:[255,192,203,255],POWDER_BLUE:[176,224,230,255],PURPLE:[128,0,128,255],REAL_ESTATE_BLUE:[14,47,68,255],RED:[255,0,0,255],RUST:[128,0,0,255],SALMON:[250,128,114,255],SEA_GREEN:[0,128,128,255],SHARP_YELLOW:[255,255,102,255],SILVER:[192,192,192,255],SIMPLE_GRAY:[204,204,204,255],SLEEPY_PINK:[255,182,193,255],SMOKE:[245,245,245,255],SMOOTH_BLUE:[76,163,221,255],SOFT_GREEN:[211,255,206,255],SOFT_MINT:[182,252,213,255],SOFT_PINK:[255,192,203,255],STRESSED_PURPLE:[138,43,226,255],SKY_BLUE:[127,229,240,255],STANDARD_GRAY:[128,128,128,255],STORM_GRAY:[105,105,102,255],SUCCESS_GREEN:[0,128,0,255],TEAL:[0,128,128,255],TENSE_SKY:[102,204,204,255],TERRACOTTA:[226,114,91,255],THICK_LUXURY:[195,151,151,255],TURQUOISE:[64,224,208,255],WALLPAPER_BEIGE:[203,190,181,255],WALLPAPER_GREEN:[220,237,193,255],WHITE:[255,255,255,255],YELLOW:[255,255,0,255]},o=Object.keys(t);e.exports={COLORS:t,randomColor:function(e=[]){const n=e.length?((e,t)=>e.length===t.length?["WHITE"]:e.filter((e=>{for(const o of t)if(e===o)return!1;return!0})))(o,e):o,s=Math.floor(Math.random()*n.length);return t[n[s]]}}},367:e=>{e.exports=class{constructor(){this.listeners=new Set,this.intervals=[],this.timeouts=[],this.playerInfoMap={}}addStateListener(e){this.listeners.add(e)}removeStateListener(e){this.listeners.remove(e)}findNode(e){let t=null;if(this.getLayers){const o=this.getLayers();for(let n in o)if(t=o[n].root.findChild(e),t)break}return t}setInterval(e,t){const o=setInterval(e,t);return this.intervals.push(o),o}setTimeout(e,t){const o=setTimeout(e,t);return this.timeouts.push(o),o}close(){for(const e in this.timeouts){const t=this.timeouts[e];clearTimeout(t)}for(const e in this.intervals){const t=this.intervals[e];clearInterval(t)}}}},532:(e,t,o)=>{const n=o(27),s=o(830),{gameNode:i,BaseNode:r}=o(55),a={[n.CIRCLE]:s.SHAPE_2D_CIRCLE,[n.POLYGON]:s.SHAPE_2D_POLYGON,[n.LINE]:s.SHAPE_2D_LINE},l={[s.SHAPE_2D_CIRCLE]:n.CIRCLE,[s.SHAPE_2D_POLYGON]:n.POLYGON,[s.SHAPE_2D_LINE]:n.LINE};class h extends r{constructor({color:e,onClick:t,shapeType:o,coordinates2d:n,border:s,fill:i,playerIds:r,effects:l,input:h,node:d,id:c}){if(!(n&&o||d))throw new Error("Shape requires coordinates2d and shapeType");super({color:e,onClick:t,coordinates2d:n,border:s,fill:i,playerIds:r,effects:l,input:h,node:d,subtype:a[o],id:c})}clone({handleClick:e,input:t,id:o}){const n=Number(o)||null;return new h({color:this.node.color,onClick:e,shapeType:l[this.node.subType],coordinates2d:this.node.coordinates2d,border:this.node.border,fill:this.node.fill,playerIds:this.node.playerIds,effects:this.node.effects,input:t,id:n})}}class d extends r{constructor({textInfo:e,playerIds:t,input:o,node:n,id:i}){if(!e&&!n)throw new Error("Text node requires textInfo");super({textInfo:e,playerIds:t,input:o,node:n,subtype:s.TEXT,id:i})}clone({handleClick:e,input:t,id:o}){const n=o||null;return new d({textInfo:Object.assign({},this.node.text),playerIds:this.playerIds?.slice(),id:n})}}class c extends r{constructor({assetInfo:e,onClick:t,coordinates2d:o,playerIds:n,effects:i,node:r,id:a}){if(!e&&!r)throw new Error("Asset node requires assetInfo");super({assetInfo:e,onClick:t,coordinates2d:o,playerIds:n,effects:i,node:r,subtype:s.ASSET,id:a})}clone({handleClick:e,input:t,id:o}){const n=o||null;return new c({assetInfo:Object.assign({},this.node.asset),playerIds:this.playerIds?.slice(),id:n})}}const u={Asset:c,Shape:h,Text:d};e.exports={gameNode:i,GameNode:u}},56:e=>{e.exports=class{constructor(e,t,o,n,s,i,r,a=[],l=null,h=null,d=null,c=null){this.id=c?Number(c):Math.floor(999999999999*Math.random()),this.children=new Array,this.color=e,this.handleClick=t,this.coordinates2d=o,this.border=n,this.fill=s,this.text=i,this.asset=r,this.effects=l,this.input=h,this.listeners=new Set,!a||a instanceof Array||(a=[a]),this.playerIds=a||[],this.subType=d}addChild(e){this.children.push(e),this.onStateChange()}addChildren(...e){for(let t=0;t<e.length;t++)this.addChild(e[t])}removeChild(e){const t=this.children.findIndex((t=>t.node.id==e));t>=0&&(this._animation&&clearInterval(this._animation),this.children.splice(t,1),this.id=this.id)}addListener(e){this.listeners.add(e)}onStateChange(){for(const e of this.listeners)e.handleStateChange(this)}clearChildren(e){if(e){const t=this.children.filter((t=>e.includes(t.id)));this.children=t}else this.children=new Array}}},27:e=>{e.exports={CIRCLE:1,POLYGON:2,LINE:3}},226:(e,t,o)=>{const{squish:n,unsquish:s}=o(983);e.exports=class{constructor({game:e,scale:t,customBottomLayer:o,customTopLayer:n,onAssetUpdate:s}){if(this.ids=new Set,this.game=e,this.gameMetadata=e.constructor.metadata&&e.constructor.metadata(),this.assets={},this.customBottomLayer=o,this.customTopLayer=n,this.initialize(),this.onAssetUpdate=s,this.playerFrames={},this.listeners=new Set,this.scale=t||{x:1,y:1},this.state=this.squish(this.game.getLayers()),this.game.tick){const e=this.gameMetadata&&this.gameMetadata.tickRate?this.gameMetadata.tickRate:60;setInterval(this.game.tick.bind(this.game),1e3/e)}}addListener(e){const t={onEvent:e,remove:()=>this.removeListener(t)};this.listeners.add(t)}removeListener(e){this.listeners.remove(e)}unsquish(e){return s(e)}squish(e,t=null){if(!e)return[];e.length;let o=[];const n={};if(this.customBottomLayer){const e=[];this.squishHelper(this.customBottomLayer.root,e,this.customBottomLayer.scale,n),o.push(e)}for(const s in e){const i=[],r=e[s],a=r.scale?{x:this.scale.x*r.scale.x,y:this.scale.y*r.scale.y}:this.scale;this.squishHelper(r.root,i,t||a,n),o.push(i)}if(this.customTopLayer){const e=[];this.squishHelper(this.customTopLayer.root,e,this.customTopLayer.scale,n),o.push(e)}return this.playerFrames=n,o.flat()}getPlayerFrame(e){return this.playerFrames[e]}handleNewAsset(e,t){return new Promise(((e,t)=>{this.initialize().then(e)}))}squishHelper(e,t,o={x:1,y:1},i={},r=new Set){e.node.listeners.has(this)||e.addListener(this);const a=n(e,o);if(t.push(a),e.node.playerIds&&e.node.playerIds.length>0&&e.node.playerIds.forEach((e=>r.add(e))),r.size>0){let t=new Set;for(let o of r)i[o]||(i[Number(o)]=[]),0===e.node.playerIds.length||e.node.playerIds.findIndex((e=>Number(e)===Number(o)))>=0?i[o].push(a):t.add(o);for(let e of t)r.delete(e)}else Object.keys(i).forEach((e=>{i[e]||(i[Number(e)]=[]),i[e].push(a)}));for(let n=0;n<e.node.children.length;n++){const s=new Set(r);this.squishHelper(e.node.children[n],t,o,i,s)}for(let e in i)for(let t in i[e]){const o=s(i[e][t]);if(o.node.playerIds.length>0&&o.node.playerIds.findIndex((t=>Number(t)===Number(e)))<0&&(console.log(o.node.playerIds),console.log(e),console.log(o.node.playerIds.indexOf(e)),254!=e))throw new Error("fuk")}}getJson(){const e=this.game.layers,t=new Array(e.length);for(const o in e){const n=e[o].root;t[o]=n}return JSON.stringify(t)}initialize(){return new Promise(((e,t)=>{const o=Object.assign({},this.assets||{}),n=this.game.constructor.metadata&&this.game.constructor.metadata(),s=n&&n.assets?n.assets:{};this.customBottomLayer&&this.customBottomLayer.assets&&Object.assign(s,this.customBottomLayer.assets),this.customTopLayer&&this.customTopLayer.assets&&Object.assign(s,this.customTopLayer.assets),this.game.getAssets&&this.game.getAssets()&&Object.assign(s,this.game.getAssets());const i=Object.assign(o,s);let r=0,a=0;const l=Object.keys(i).length;for(const t in i)i[t].getData().then((o=>{let n=0;const s=new Array(32);for(;n<32&&n<t.length;)s[n]=t.charCodeAt(n),n++;const h=(o.length+32).toString(36),d={image:1,audio:2,font:3}[i[t].info.type];let c="";for(let e=0;e<10-h.length;e++)c+="0";for(let e=h.length;e<10;e++)c+=h.charAt(e-h.length);const u=new Array(10);for(let e=0;e<10;e++)u[e]=h.charCodeAt(e);if(this.assets[t]=[1,d,...u,...s,...o],r+=this.assets[t].length,a+=1,a==l){const t=new Array(r);for(let e=0;e<r;e++)for(const o in this.assets)for(let n=0;n<this.assets[o].length;n++)t[e++]=this.assets[o][n];this.assetBundle=t,e(t)}})).catch((e=>{console.error("Unable to get asset data for key "+t),console.error(e)}))}))}handleStateChange(e,t){this.listeners.size>0&&(this.state=this.squish(this.game.getLayers()),this.broadcast())}broadcast(){for(const e of this.listeners)e.onEvent(this.state)}}},797:(e,t,o)=>{const{GameNode:n}=o(532),s=o(27),i=o(137),r=o(784),a=o(367);e.exports=class extends a{constructor(e){var t;super(),this.planeSize=e,this.plane=(t=this.planeSize,new n.Shape({shapeType:s.POLYGON,coordinates2d:i.rectangle(0,0,t,t)})),this.fakeRoot=new n.Shape({shapeType:s.POLYGON,coordinates2d:i.rectangle(0,0,0,0),fill:r.COLORS.BLACK}),this.layers=[{root:this.fakeRoot}]}updatePlaneSize(e){this.planeSize=e,this.plane.node.coordinates2d=i.rectangle(0,0,e,e)}getLayers(){return this.layers}getPlane(){return this.plane}getPlaneSize(){return this.planeSize}getViewRoot(){return this.fakeRoot}}},626:(e,t,o)=>{const{GameNode:n}=o(532);e.exports={CONSTRUCTOR_TO_TYPE:{Asset:1,Shape:2,Text:3},TYPE_TO_CONSTRUCTOR:{1:n.Asset,2:n.Shape,3:n.Text}}},636:e=>{e.exports={getPath:(e,t,o,n,s=100,i=100)=>{const r=[];let a=!0;for(;a;){const l=(0===r.length?e:r[r.length-1][0])+o,h=(0===r.length?t:r[r.length-1][1])+n;if(l<0||l>s||h<0||h>i){let e=l,t=h;l<0?e=0:l>s&&(e=s),h<0?t=0:h>i&&(t=i),r[r.length-1][0]!==e&&r[r.length-1][1]!==t&&r.push([e,t]),a=!1}else r.push([l,h])}return r}}},983:(e,t,o)=>{const n=o(56),{CONSTRUCTOR_TO_TYPE:s,TYPE_TO_CONSTRUCTOR:i}=o(626),r=o(253),{squishId:a}=o(751),{squishColor:l}=o(879),{squishPlayerIds:h}=o(410),{squishPos:d}=o(579),{squishFill:c}=o(409),{squishSize:u}=o(709),{squishHandleClick:f}=o(393),{squishBorder:p}=o(593),{squishSubType:g}=o(937),{squishInput:y}=o(366),{squishCoordinates2d:w}=o(247),{squishEffect:x}=o(873),{squishText:m}=o(17),{squishAsset:E}=o(203),S={id:a,color:l,playerIds:h,pos:d,coordinates2d:w,fill:c,size:u,text:m,asset:E,effects:x,handleClick:f,border:p,subType:g,input:y},C={};for(const e in S)C[Number(S[e].type)]=e;e.exports={squish:(e,t=null)=>{let o=[];const n=e.node,i=(()=>{const e=Object.keys(S).filter((e=>S[e].dependsOn&&S[e].dependsOn.length>0));return[Object.keys(S).filter((e=>!S[e].dependsOn||0===S[e].dependsOn.length)),e].flat()})();for(const e in i){const s=i[e];if(s in n){const e=n[s];if(null!=e){const i=S[s].squish(e,t,n),r=i.length+3,a=Math.min(255,r),l=Math.min(255,Math.max(0,r-255));o.push([S[s].type,l,a,...i])}}}let a=s[e.constructor.name];a||(a=s[r[n.subType]]);const l=o.flat(),h=l.length+5,d=Math.min(255,h),c=Math.min(255,Math.max(0,h-255));return[3,Math.min(255,Math.max(0,h-510)),c,d,a,...l]},unsquish:e=>{if(3!=e[0])throw new Error("Squished[0] isnt 3.");if(e.length!==e[1]+e[2]+e[3])throw new Error("Bad length value");let t=5,o=new n;for(;t<e.length;){const n=e[t],s=e[t+1]+e[t+2],i=e.slice(t+3,t+s);if(!C[n]){console.warn("Unknown sub frame type "+n);break}{const e=C[n],t=(0,S[e].unsquish)(i,Object.assign({},o));o[e]=t}t+=s}const s=i[e[4]];return s?new s({node:o}):{node:o}}}},203:(e,t,o)=>{const{getFractional:n}=o(660),s={type:48,squish:(e,t)=>{const o=Object.keys(e)[0],s=new Array(10+o.length),i=e[o],r=t?t.x*i.pos.x+Math.round(100*(1-t.x))/2:i.pos.x,a=t?t.y*i.pos.y+Math.round(100*(1-t.y))/2:i.pos.y,l=t?t.x*i.size.x:i.size.x,h=t?t.y*i.size.y:i.size.y,d=i.startTime||0;s[0]=Math.floor(r),s[1]=n(r),s[2]=Math.floor(a),s[3]=n(a),s[4]=Math.floor(l),s[5]=n(l),s[6]=Math.floor(h),s[7]=n(h),s[8]=Math.floor(d),s[9]=n(d);for(let e=0;e<o.length;e++)s[10+e]=o.codePointAt(e);return s},unsquish:e=>{const t=e[0]+e[1]/100,o=e[2]+e[3]/100,n=e[4]+e[5]/100,s=e[6]+e[7]/100,i=e[8]+e[9]/100;return{[String.fromCodePoint.apply(null,e.slice(10))]:{pos:{x:t,y:o},size:{x:n,y:s},startTime:i}}}};e.exports={ASSET_SUBTYPE:48,squishAsset:s}},593:e=>{e.exports={BORDER_SUBTYPE:54,squishBorder:{type:54,squish:e=>[e],unsquish:e=>e[0]}}},879:e=>{e.exports={COLOR_SUBTYPE:42,squishColor:{type:42,squish:e=>[e[0],e[1],e[2],e[3]],unsquish:e=>[e[0],e[1],e[2],e[3]]}}},247:(e,t,o)=>{const{getFractional:n}=o(660),s=o(830),i=(e,t)=>e*t+Math.round(100*(1-e))/2,r={type:52,squish:(e,t,o)=>{const r=e.flat(),a=new Array(2*r.length);if(o.subType==s.SHAPE_2D_CIRCLE)if(t){const e=i(t.x,r[0]);a[0]=e,a[1]=n(e);const o=i(t.y,r[1]);let s;a[2]=o,a[3]=n(o),s=t.x===t.y?t.x*r[2]:Math.sqrt(Math.pow(100*t.x,2)+Math.pow(100*t.y,2))*(r[2]/100),a[4]=Math.floor(s),a[5]=n(s)}else{const e=r[0];a[0]=Math.floor(e),a[1]=n(e);const t=r[1];a[2]=Math.floor(t),a[3]=n(t);const o=r[2];a[4]=Math.round(o),a[5]=n(o)}else for(const e in r)if(t){const o=e%2==0?t.x:t.y,s=o*r[e]+Math.round(100*(1-o))/2;a[2*e]=s,a[2*e+1]=n(s)}else a[2*e]=Math.floor(r[e]),a[2*e+1]=Math.round(100*(r[e]-Math.floor(r[e])));return a},dependsOn:["subType"],unsquish:(e,{subType:t})=>{const o=new Array(e.length/2);for(let t=0;t<e.length;t+=2){const n=e[t]+e[t+1]/100;o[t/2]=n}if(t===s.SHAPE_2D_POLYGON||t===s.SHAPE_2D_LINE){const e=new Array(o.length/2);for(let t=0;t<o.length;t+=2)e[t/2]=[o[t],o[t+1]];return e}return o}};e.exports={COORDINATES_2D_SUBTYPE:52,squishCoordinates2d:r}},873:e=>{const t={type:49,squish:e=>{if(e.shadow){const t="shadow";let o=t.length+4;e.shadow.blur&&(o+=2);const n=new Array(o);for(let e=0;e<t.length;e++)n[e]=t.codePointAt(e);return n[t.length]=e.shadow.color[0],n[t.length+1]=e.shadow.color[1],n[t.length+2]=e.shadow.color[2],n[t.length+3]=e.shadow.color[3],e.shadow.blur&&(n[t.length+4]=Math.floor(e.shadow.blur/10),n[t.length+5]=e.shadow.blur%10),n}},unsquish:e=>{const t=String.fromCodePoint.apply(null,e.slice(0,6)),o=e.slice(6,10);let n;e.length>10&&(n=10*e[10]+e[11]);const s={[t]:{color:o}};return n&&(s[t].blur=n),s}};e.exports={EFFECTS_SUBTYPE:49,squishEffect:t}},409:e=>{e.exports={FILL_SUBTYPE:53,squishFill:{type:53,squish:e=>[e[0],e[1],e[2],e[3]],unsquish:e=>[e[0],e[1],e[2],e[3]]}}},393:e=>{e.exports={ONCLICK_SUBTYPE:50,squishHandleClick:{type:50,squish:e=>e?[1]:[0],unsquish:e=>1===e[0]}}},751:e=>{const t={type:43,squish:e=>{const t=e.toString();let o=[];if(t.length>2){let e;for(e=0;e+2<=t.length;e+=2)o.push(t.substring(e,e+2));e==t.length-1&&o.push(t.substring(e,e+2))}else 1===t.length?o.push("0"+t):o.push(t);if(o.length<8)for(;o.length<8;)o=["00",...o];return o.map((e=>new Number(e)))},unsquish:e=>{let t="";for(let o=e.length-1;o>=0;o--)t=(e[o]>9?e[o]:"0"+e[o])+t;return new Number(t)}};e.exports={ID_SUBTYPE:43,squishId:t}},366:e=>{const t={type:51,squish:e=>{const t=new Array(e.type.length);for(let o=0;o<e.type.length;o++)t[o]=e.type.codePointAt(o);return t},unsquish:e=>({type:String.fromCodePoint.apply(null,e)})};e.exports={INPUT_SUBTYPE:51,squishInput:t}},410:e=>{e.exports={PLAYER_ID_SUBTYPE:44,squishPlayerIds:{type:44,squish:e=>e,unsquish:e=>e}}},579:e=>{const t=e=>Math.round(100*(e-Math.floor(e))),o={type:45,squish:e=>[Math.floor(e.x),t(e.x),Math.floor(e.y),t(e.y)],unsquish:e=>({x:e[0]+e[1]/100,y:e[2]+e[3]/100})};e.exports={POS_SUBTYPE:45,squishPos:o}},709:e=>{const t=e=>{Math.round(100*(e-Math.floor(e)))},o={type:46,squish:e=>[Math.floor(e.x),t(e.x),Math.floor(e.y),t(e.y)],unsquish:e=>({x:e[0]+e[1]/100,y:e[2]+e[3]/100})};e.exports={SIZE_SUBTYPE:46,squishSize:o}},937:e=>{e.exports={SUBTYPE_TYPE:55,squishSubType:{type:55,squish:e=>[e],unsquish:e=>e[0]}}},17:(e,t,o)=>{const{hypLength:n}=o(660),s=o(784),{squishColor:i}=o(879),r={type:47,squish:(e,t)=>{const o=t?e.x*t.x+Math.round(100*(1-t.x))/2:e.x,r=t?e.y*t.y+Math.round(100*(1-t.y))/2:e.y,a=e.align||"left",l=e.font||"default",h=new Array(e.text.length+10+a.length+l.length);h[0]=Math.floor(o),h[1]=Math.round(100*(o-Math.floor(o))),h[2]=Math.floor(r),h[3]=Math.round(100*(r-Math.floor(r)));const d=e.size||1,c=t?d*n(t.x,t.y):d;h[4]=Math.floor(c),h[5]=Math.round(100*(c-Math.floor(c)));const u=e.color||s.BLACK,f=i.squish(u);for(let e=0;e<f.length;e++)h[6+e]=f[e];h[6+f.length]=3*[...a].length,h[6+f.length+1]=3*[...l].length;let p=0;for(let e=0;e<[...a].length;e++){const t=[...a][e].codePointAt(0).toString();let o;o=1==t.length?["00","00",`0${t}`]:2==t.length?["00","00",`${t}`]:3==t.length?["00",`0${t.charAt(0)}`,`${t.charAt(1)}${t.charAt(2)}`]:4==t.length?["00",`${t.charAt(0)}${t.charAt(1)}`,`${t.charAt(2)}${t.charAt(3)}`]:5==t.length?[`0${t.charAt(0)}`,`${t.charAt(1)}${t.charAt(2)}`,`${t.charAt(3)}${t.charAt(4)}`]:[`${t.charAt(0)}${t.charAt(1)}`,`${t.charAt(2)}${t.charAt(3)}`,`${t.charAt(4)}${t.charAt(5)}`],h[6+f.length+2+p]=Number(o[0]),h[6+f.length+2+p+1]=Number(o[1]),h[6+f.length+2+p+2]=Number(o[2]),p+=3}let g=0;for(let e=0;e<[...l].length;e++){const t=[...l][e].codePointAt(0).toString();let o;o=1==t.length?["00","00",`0${t}`]:2==t.length?["00","00",`${t}`]:3==t.length?["00",`0${t.charAt(0)}`,`${t.charAt(1)}${t.charAt(2)}`]:4==t.length?["00",`${t.charAt(0)}${t.charAt(1)}`,`${t.charAt(2)}${t.charAt(3)}`]:5==t.length?[`0${t.charAt(0)}`,`${t.charAt(1)}${t.charAt(2)}`,`${t.charAt(3)}${t.charAt(4)}`]:[`${t.charAt(0)}${t.charAt(1)}`,`${t.charAt(2)}${t.charAt(3)}`,`${t.charAt(4)}${t.charAt(5)}`];let n=6+f.length+2+3*[...a].length;h[n+g]=Number(o[0]),h[n+g+1]=Number(o[1]),h[n+g+2]=Number(o[2]),g+=3}let y=0;for(let t=0;t<[...e.text].length;t++){const o=[...e.text][t].codePointAt(0).toString();let n;n=1==o.length?["00","00",`0${o}`]:2==o.length?["00","00",`${o}`]:3==o.length?["00",`0${o.charAt(0)}`,`${o.charAt(1)}${o.charAt(2)}`]:4==o.length?["00",`${o.charAt(0)}${o.charAt(1)}`,`${o.charAt(2)}${o.charAt(3)}`]:5==o.length?[`0${o.charAt(0)}`,`${o.charAt(1)}${o.charAt(2)}`,`${o.charAt(3)}${o.charAt(4)}`]:[`${o.charAt(0)}${o.charAt(1)}`,`${o.charAt(2)}${o.charAt(3)}`,`${o.charAt(4)}${o.charAt(5)}`];let s=6+f.length+2+3*[...a].length+3*[...l].length;h[s+y]=Number(n[0]),h[s+y+1]=Number(n[1]),h[s+y+2]=Number(n[2]),y+=3}return h},unsquish:e=>{const t=e[0]+e[1]/100,o=e[2]+e[3]/100,n=e[4]+e[5]/100,s=e.slice(6,10),i=e[10],r=e[11],a=e.slice(12,12+i),l=e.slice(12+i,12+i+r),h=e.slice(12+i+r);let d=[];for(let e=0;e<a.length;e+=3){let t=a[e].toString();1==t.length&&(t=`0${t}`);let o=a[e+1].toString();1==o.length&&(o=`0${o}`);let n=a[e+2].toString();1==n.length&&(n=`0${n}`);const s=t+o+n;d.push(s)}const c=String.fromCodePoint.apply(null,d);let u=[];for(let e=0;e<l.length;e+=3){let t=l[e].toString();1==t.length&&(t=`0${t}`);let o=l[e+1].toString();1==o.length&&(o=`0${o}`);let n=l[e+2].toString();1==n.length&&(n=`0${n}`);const s=t+o+n;u.push(s)}const f=String.fromCodePoint.apply(null,u),p=[];for(let e=0;e<h.length;e+=3){let t=h[e].toString();1==t.length&&(t=`0${t}`);let o=h[e+1].toString();1==o.length&&(o=`0${o}`);let n=h[e+2].toString();1==n.length&&(n=`0${n}`);const s=t+o+n;p.push(s)}return{x:t,y:o,text:String.fromCodePoint.apply(null,p),size:n,color:s,align:c,font:f}}};e.exports={TEXT_SUBTYPE:47,squishText:r}},253:(e,t,o)=>{const{GameNode:n}=o(532),s=o(830);e.exports={[[s.ASSET]]:n.Asset,[[s.TEXT]]:n.Text,[[s.SHAPE_2D_POLYGON]]:n.Shape,[[s.SHAPE_2D_CIRCLE]]:n.Shape,[[s.SHAPE_2D_LINE]]:n.Shape}},830:e=>{e.exports={ASSET:1,TEXT:2,SHAPE_2D_POLYGON:3,SHAPE_2D_CIRCLE:4,SHAPE_2D_LINE:5}},907:(e,t,o)=>{const{getRandomTerrain:n,getRandomStartPoint:s}=o(607),i=e=>{for(let t=0;t<e.length;t++)for(let o=0;o<e[t].length;o++)e[t][o]={filled:e[t][o].filled,north:e[t][o].north,south:e[t][o].south,east:e[t][o].east,west:e[t][o].west}},r=(e,t,o,a,l,h=0)=>{if(0===o||3===h)return e;const d=(e=>{const t=[];return e.forEach(((e,o)=>{t[o]=[],e.forEach((e=>{t[o].push({...e})}))})),t})(e);n()(d,s(a,l,t),a,l,t);const c=((e,t,o,n)=>{const s=[];for(let r=0;r<o;r++)for(let o=0;o<n;o++){const n=[],a={x:r,y:o};for(;;){const o=e[a.x][a.y];if(s.findIndex((e=>e.x===a.x&&e.y===a.y))>-1||a.x===t.x&&a.y===t.y||o.filled){s.push(...n);break}if((!o.north||o.wentNorth)&&(!o.south||o.wentSouth)&&(!o.east||o.wentEast)&&(!o.west||o.wentWest))return!1;if(n.push({...a}),o.south&&!o.wentSouth)o.wentSouth=!0,a.y=a.y+1;else if(o.east&&!o.wentEast)o.wentEast=!0,a.x=a.x+1;else if(o.north&&!o.wentNorth)o.wentNorth=!0,a.y=a.y-1;else{if(!o.west||o.wentWest)return!1;o.wentWest=!0,a.x=a.x-1}}i(e)}return!0})(d,t,a,l);return c?r(d,t,o-1,a,l,0):r(e,t,o,a,l,h+1)};e.exports={terrainGenerator:(e={x:100,y:100},t={x:5,y:5},o=5)=>{const{width:n,height:s}=((e,t)=>{const o=e.x,n=e.y,s=t.x,i=t.y;return{width:Math.floor(o/s),height:Math.floor(n/i)}})(e,t);let i=((e,t)=>{const o=[],n={filled:!1,north:!0,south:!0,east:!0,west:!0};for(let s=0;s<e;s++){o[s]=[];for(let i=0;i<t;i++){const r={...n};0===s?r.west=!1:s===e-1&&(r.east=!1),0===i?r.north=!1:i===t-1&&(r.south=!1),o[s].push(r)}}return o})(n,s);const a={x:Math.floor(Math.random()*n),y:Math.floor(Math.random()*s)};return i=r(i,a,o,n,s),i}}},607:e=>{const t=(e,{x:t,y:o},n,s,i)=>{t<0||t>=n||o<0||o>=s||t===i.x&&o===i.y||e[t][o].filled||(e[t][o].north&&(e[t][o-1].south=!1),e[t][o].south&&(e[t][o+1].north=!1),e[t][o].east&&(e[t+1][o].west=!1),e[t][o].west&&(e[t-1][o].east=!1),e[t][o].filled=!0,e[t][o].north=!1,e[t][o].south=!1,e[t][o].east=!1,e[t][o].west=!1)},o=[(e,{x:o,y:n},s,i,r)=>{const a=Math.floor(4*Math.random());t(e,{x:o,y:n},s,i,r),0===a?(t(e,{x:o+1,y:n},s,i,r),t(e,{x:o,y:n+1},s,i,r),t(e,{x:o+1,y:n+1},s,i,r)):1===a?(t(e,{x:o-1,y:n},s,i,r),t(e,{x:o,y:n+1},s,i,r),t(e,{x:o-1,y:n+1},s,i,r)):2===a?(t(e,{x:o,y:n-1},s,i,r),t(e,{x:o+1,y:n},s,i,r),t(e,{x:o+1,y:n-1},s,i,r)):(t(e,{x:o,y:n-1},s,i,r),t(e,{x:o-1,y:n},s,i,r),t(e,{x:o-1,y:n-1},s,i,r))},(e,{x:o,y:n},s,i,r)=>{const a=Math.floor(4*Math.random());t(e,{x:o,y:n},s,i,r),0===a?(t(e,{x:o,y:n+1},s,i,r),t(e,{x:o,y:n+2},s,i,r),t(e,{x:o,y:n+3},s,i,r)):1===a?(t(e,{x:o+1,y:n},s,i,r),t(e,{x:o+2,y:n},s,i,r),t(e,{x:o+3,y:n},s,i,r)):2===a?(t(e,{x:o-1,y:n},s,i,r),t(e,{x:o-2,y:n},s,i,r),t(e,{x:o-3,y:n},s,i,r)):(t(e,{x:o,y:n-1},s,i,r),t(e,{x:o,y:n-2},s,i,r),t(e,{x:o,y:n-3},s,i,r))},(e,{x:o,y:n},s,i,r)=>{const a=Math.floor(4*Math.random());t(e,{x:o,y:n},s,i,r),0===a?(t(e,{x:o,y:n+1},s,i,r),t(e,{x:o,y:n+2},s,i,r),t(e,{x:o+1,y:n+2},s,i,r)):1===a?(t(e,{x:o+1,y:n},s,i,r),t(e,{x:o+2,y:n},s,i,r),t(e,{x:o+2,y:n-1},s,i,r)):2===a?(t(e,{x:o-1,y:n},s,i,r),t(e,{x:o-2,y:n},s,i,r),t(e,{x:o-2,y:n+1},s,i,r)):(t(e,{x:o,y:n-1},s,i,r),t(e,{x:o,y:n-2},s,i,r),t(e,{x:o-1,y:n-2},s,i,r))},(e,{x:o,y:n},s,i,r)=>{const a=Math.floor(4*Math.random());t(e,{x:o,y:n},s,i,r),0===a?(t(e,{x:o,y:n+1},s,i,r),t(e,{x:o-1,y:n+1},s,i,r),t(e,{x:o-1,y:n+2},s,i,r)):1===a?(t(e,{x:o+1,y:n},s,i,r),t(e,{x:o+1,y:n+1},s,i,r),t(e,{x:o+2,y:n+1},s,i,r)):2===a?(t(e,{x:o-1,y:n},s,i,r),t(e,{x:o-1,y:n+1},s,i,r),t(e,{x:o-2,y:n+1},s,i,r)):(t(e,{x:o,y:n-1},s,i,r),t(e,{x:o-1,y:n-1},s,i,r),t(e,{x:o-1,y:n-2},s,i,r))}];e.exports={getRandomTerrain:()=>o[Math.floor(Math.random()*o.length)],getRandomStartPoint:(e,t,o)=>{const n={x:Math.floor(Math.random()*e),y:Math.floor(Math.random()*t)};for(;n.x===o.x&&n.y===o.y;)n.x=Math.floor(Math.random()*e),n.y=Math.floor(Math.random()*t);return n}}},526:e=>{const t=(e,o,n,s=[])=>{if(!n||n(e)&&e.node.id!==o.node.id){const t=e.node.text,n=e.node.coordinates2d||[[t.x,t.y],[t.x,t.y],[t.x,t.y],[t.x,t.y],[t.x,t.y]],i=o.node.coordinates2d,r=n[0][0],a=n[1][0],l=i[0][0],h=i[1][0],d=n[0][1],c=n[2][1],u=i[0][1],f=i[2][1];h<r||a<l||d>f||u>c||s.push(e)}for(const i in e.node.children)t(e.node.children[i],o,n,s);return s};e.exports={checkCollisions:(e,o,n=null)=>t(e,o,n)}},660:e=>{e.exports={hypLength:(e,t)=>Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),getFractional:e=>Math.round(100*(e-Math.floor(e)))}},335:e=>{e.exports=function(e,t){const o={get:(e,t,o)=>Reflect.get(e,t,o),defineProperty(e,o,n){const s=Reflect.defineProperty(e,o,n);return t&&t(),s},deleteProperty(e,o){const n=Reflect.deleteProperty(e,o);return t&&t(),n}},n=Proxy.revocable(e,o);return e.free=()=>{n.revoke()},n.proxy}},137:e=>{e.exports={triangle:(e,t,o,n,s,i)=>[[e,t],[o,n],[s,i],[e,t]],rectangle:(e,t,o,n)=>[[e,t],[e+o,t],[e+o,t+n],[e,t+n],[e,t]]}},298:(e,t,o)=>{const{GameNode:n}=o(532),s=o(27),i=o(137),r=o(526),a=o(784);e.exports={getView:(e,t,o,l={},h={})=>{const d=r.checkCollisions(e,{node:{coordinates2d:i.rectangle(t.x,t.y,t.w,t.h)}},(t=>t.node.id!==e.node.id)),c=new n.Shape({shapeType:s.POLYGON,coordinates2d:i.rectangle(0,0,0,0),fill:a.COLORS.BLACK}),u=[];return d.length>0&&d.forEach((e=>{const n=[],s=e.node.coordinates2d||[[e.node.text.x,e.node.text.y],[e.node.text.x,e.node.text.y],[e.node.text.x,e.node.text.y],[e.node.text.x,e.node.text.y],[e.node.text.x,e.node.text.y]];for(let o in s){const i=s[o],r=i[0],a=i[1];let d=Math.max(Math.min(r-t.x,100),0),c=Math.max(Math.min(a-t.y,100),0);d=(h.x||1)*d,c=(h.y||1)*c,(!l.filter||l.filter(e))&&(l.x&&(d+=l.x),l.y&&(c+=l.y)),d<0?d=0:d>100&&(d=100),c<0?c=0:c>100&&(c=100),n.push([d,c])}{const t=e.clone({handleClick:null===e.node.handleClick||void 0===e.node.handleClick?null:e.node.handleClick});if(n&&n.length&&(t.node.text&&(t.node.text.x=n[0][0],t.node.text.y=n[0][1]),n.length&&(t.node.coordinates2d=n),t.node.asset)){const e=t.node.coordinates2d[0],o=t.node.coordinates2d[1],n=t.node.coordinates2d[2],s=o[0]-e[0],i=n[1]-o[1];Object.values(t.node.asset)[0].pos.x=e[0],Object.values(t.node.asset)[0].pos.y=e[1],Object.values(t.node.asset)[0].size.x=s,Object.values(t.node.asset)[0].size.y=i}t.node.playerIds=o||[],u.push(t)}})),u.forEach((e=>c.addChild(e))),c}}},290:(e,t,o)=>{const n=o(737);e.exports={getAppDataPath:()=>{if(!process)return"";switch(process.platform){case"darwin":return n.join(process.env.HOME,"Library","Application Support","homegames");case"win32":return n.join(process.env.APPDATA,"homegames");case"linux":return n.join(process.env.HOME,".homegames");default:console.log("Unsupported platform!"),process.exit(1)}}}},672:(e,t,o)=>{const{Homepad:n}=o(645),s=new n,i={"0756":o(333),"0762":o(333),"0765":o(333),"0766":o(333),"0767":o(333),1e3:o(333),1004:o(333)};let r,{squish:a,unsquish:l,Colors:h}=i["0766"];h=h.COLORS;const d=new Worker("socket.js"),c=document.getElementById("game"),u={};let f,p,g,y,w,x,m,E=!1,S=[];new Promise(((e,t)=>{fetch("/config.json").then((t=>{t.json().then((t=>{e(t)}))}))})).then((e=>{const t=e.HOME_PORT||7001;if(e.PUBLIC_CLIENT){const e=new URLSearchParams(window.location.search).get("code");if(e){const e=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;window.history.pushState({path:e},"",e)}window.serverCode=e?e.toUpperCase():window.prompt("Enter server code").toUpperCase()}const o=document.getElementById("performance-data");d.onmessage=e=>{if(e.data.constructor===Object){if("SOCKET_CLOSE"===e.data.type&&(E=!1),"ERROR"===e.data.type){E=!1;const t=document.createElement("div"),o=document.createElement("div");o.innerHTML="Error: "+e.data.message;const n=document.createElement("a");n.href="https://public.homegames.link/code",n.innerHTML="Try again",t.appendChild(o),t.appendChild(n),(e=>{const t=document.createElement("div");t.style.position="absolute",t.style.width="100vw;",t.style.top="0",t.style["text-align"]="center",t.style["font-size"]="10vw",t.appendChild(e),document.body.appendChild(t)})(t)}}else if(f=new Uint8ClampedArray(e.data),2==f[0]){if(window.playerId=f[1],2==f.length&&d.postMessage({type:"finishReady",playerId:window.playerId}),f.length>2){const e=f[2],t=f[3];p={x:e,y:t},r={x:f[4],y:f[5]},f[6];const o=String.fromCharCode.apply(null,f.slice(7,7+f[6]));window.squishVersion=o;const n=i[o];n&&(a=n.squish,l=n.unsquish,h=n.Colors),R()}}else if(1==f[0])N(f);else if(9==f[0])p={x:f[1],y:f[2]},R();else if(5===f[0]){w=!1;let e=String(f[1])+(String(f[2]).length>1?f[2]:"0"+f[2]);const t=window.serverCode?"public.homegames.link":window.location.hostname,o=window.serverCode?82:e;d.postMessage({socketInfo:{hostname:t,playerId:window.playerId||null,port:Number(o),secure:"localhost"!==window.location.host&&window.isSecureContext,serverCode:window.serverCode,spectating:w}})}else if(6===f[0]){w=!0;let e=String(f[1])+(String(f[2]).length>1?f[2]:"0"+f[2]);const t=window.serverCode?"public.homegames.link":window.location.hostname,o=window.serverCode?82:e;d.postMessage({socketInfo:{hostname:t,playerId:window.playerId||null,port:Number(o),secure:"localhost"!==window.location.host&&window.isSecureContext,serverCode:window.serverCode,spectating:w}})}else if(7===f[0])g();else if(8===f[0]){let e=String(f[1])+(String(f[2]).length>1?f[2]:"0"+f[2]);if(!x){const t=window.location.hostname;x=new WebSocket(`wss://${t}:${e}`),x.onopen=()=>{console.log("hot client opened")},x.onerror=e=>{console.log("hot client err"),console.log(e)},x.onmessage=e=>{"reload"===e.data&&location.reload()}}}else 3!=f[0]||E||(E=!0,G())};const n=document.createElement("canvas"),s=document.createElement("canvas"),c=document.createElement("h3"),u=document.createElement("h3"),g=()=>{if(!m){m=!0;const e=document.createElement("div"),t=document.createElement("div");e.style="float: left; margin-right: 50px",t.style="float: left",e.appendChild(n),t.appendChild(s),o.appendChild(e),e.appendChild(c),o.appendChild(t),t.appendChild(u)}},y=window.serverCode?"public.homegames.link":window.location.hostname,S=window.serverCode?82:t;d.postMessage({socketInfo:{hostname:y,playerId:window.playerId||null,port:S,secure:"localhost"!==window.location.host&&window.isSecureContext,serverCode:window.serverCode}}),(()=>{const e=(()=>{const e=navigator.userAgent,t={};/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?t.deviceType="tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?t.deviceType="mobile":navigator.maxTouchPoints&&navigator.maxTouchPoints>2?t.deviceType="tablet":t.deviceType="desktop";const o=window.innerWidth,n=window.innerHeight;let s=null;return o&&n&&(s=o/n),t.aspectRatio=s,t})(),t={clientInfo:e},o=new URLSearchParams(window.location.search);if(o.get("gameId")&&o.get("versionId")){const e=o.get("gameId"),n=o.get("versionId"),s=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;window.history.pushState({path:s},"",s),t.requestedGame={gameId:e,versionId:n}}d.postMessage(t)})()})),window.playerId=null;let C=!1;const A={};let I,L;const T={},O={},_=document.getElementById("homegames-main"),M=h.BLACK;_.style.background=`rgba(${M[0]}, ${M[1]}, ${M[2]}, ${M[3]})`;const b=c.getContext("2d",{alpha:!1}),R=()=>{const e=window.innerWidth,t=window.innerHeight;let o,n;if(e*p.y/p.x<=t){const e=window.innerWidth;n=e,o=Math.floor(e*(p.y/p.x))}else{const e=window.innerHeight;n=Math.floor(e*(p.x/p.y)),o=e}c.height=2*o,c.width=2*n,y=.5*c.width,clientHeight=.5*c.height,c.style.height=`${clientHeight}px`,c.style.width=`${y}px`},N=e=>{let t=0;for(;e&&t<e.length;)if(1===e[t]){const o=e[t+1];if(1===o){const o=String.fromCharCode.apply(null,e.slice(t+2,t+12)),n=parseInt(o,36),s=e.slice(t+12,t+12+32),i=e.slice(t+12+32,t+12+n),r=String.fromCharCode.apply(null,s.filter((e=>e)));let a="";for(let e=0;e<i.length;e++)a+=String.fromCharCode(i[e]);const l=btoa(a);T[r]={type:"image",data:"data:image/jpeg;base64,"+l},t+=12+n}else if(2===o){const o=String.fromCharCode.apply(null,e.slice(t+2,t+12)),n=parseInt(o,36),s=e.slice(t+12,t+12+32),i=e.slice(t+12+32,t+12+n),r=String.fromCharCode.apply(null,s.filter((e=>e)));I?I.decodeAudioData(i.buffer,(e=>{T[r]={type:"audio",data:e,decoded:!0}}),(e=>{console.log("unable to decode audio data"),console.log(e)})):T[r]={type:"audio",data:i.buffer,decoded:!1},t+=12+n}else if(3===o){const o=String.fromCharCode.apply(null,e.slice(t+2,t+12)),n=parseInt(o,36),s=e.slice(t+12,t+12+32),i=e.slice(t+12+32,t+12+n),r=String.fromCharCode.apply(null,s.filter((e=>e))),a=new FontFace(r,i);a&&a.load().then((e=>{document.fonts.add(e),T[r]={type:"font",data:e,name:r}})),t+=12+n}else console.error("Unknown asset type: "+o)}};let v,P,$=[];function k(e){const t=new Set(Object.keys(u));b.clearRect(0,0,c.width,c.height);let o=0;for($=[];e&&o<e.length;){e[o];const n="0750"===window.squishVersion||"0751"===window.squishVersion?e[o+1]:e[o+1]+e[o+2]+e[o+3];let s=l(e.slice(o,o+n)).node;if(!s.coordinates2d&&s.input&&s.text){const e=Math.floor(c.width),t=s.text.size/100*e;b.font=t+"px sans-serif";const o=b.measureText(s.text.text);let n=s.text.x*c.width/100;s.text.align&&"center"==s.text.align&&(n-=o.width/2),n=n/c.width*100;const i=o.actualBoundingBoxDescent-o.actualBoundingBoxAscent,r=o.width/c.width*100,a=i/c.height*100,l=[!!s.handleClick,s.input&&s.input.type,s.id,[n,s.text.y,n+r,s.text.y,n+r,s.text.y+a,n,s.text.y+a,n,s.text.y]];$.push(l)}else if(null!==s.coordinates2d&&void 0!==s.coordinates2d){const e=[!!s.handleClick,s.input&&s.input.type,s.id,s.coordinates2d];if($.push(e),s.effects&&s.effects.shadow){const e=s.effects.shadow.color;b.shadowColor="rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")",s.effects.shadow.blur&&(b.shadowBlur=s.effects.shadow.blur)}if(s.color&&(b.globalAlpha=s.color[3]/255),null!==s.fill&&void 0!==s.fill&&(b.fillStyle="rgba("+s.fill[0]+","+s.fill[1]+","+s.fill[2]+","+s.fill[3]+")"),void 0!==s.border&&null!==s.border&&(b.lineWidth=s.border/255*.1*c.width,b.strokeStyle="rgba("+s.color[0]+","+s.color[1]+","+s.color[2]+","+s.color[3]+")"),null!==s.coordinates2d&&void 0!==s.coordinates2d){b.beginPath();const e=s.coordinates2d[0];b.moveTo(e[0]*c.width/100,e[1]*c.height/100);for(let e=1;e<s.coordinates2d.length;e++){const t=s.coordinates2d[e];b.lineTo(c.width/100*t[0],t[1]*c.height/100)}void 0!==s.fill&&null!==s.fill&&b.fill(),void 0!==s.border&&null!==s.border&&b.stroke()}b.shadowColor=null,b.shadowBlur=0,b.lineWidth=0,b.strokeStyle=null}if(s.text){b.globalAlpha=s.text.color[3]/255,b.fillStyle=`rgba(${s.text.color[0]}, ${s.text.color[1]}, ${s.text.color[2]}, ${s.text.color[3]})`;const e=Math.floor(c.width),t=s.text.size/100*e;b.font=t+"px "+(s.text.font&&"default"!==s.text.font?s.text.font:"sans-serif"),s.text.align&&(b.textAlign=s.text.align),b.textBaseline="top",b.fillText(s.text.text,s.text.x*c.width/100,s.text.y*c.height/100)}if(s.asset){const e=Object.keys(s.asset)[0];if(T[e]&&"audio"===T[e].type)!u[e]&&I&&T[e].decoded?(L=I.createBufferSource(),L.connect(I.destination),L.buffer=T[e].data,L.onended=()=>{delete u[e]},L.start(0,s.asset[e].startTime||0),u[e]=L):!u[e]&&I?console.warn("Cant play audio"):u[e]&&t.delete(e);else{const t=s.asset[e];let o;if(O[e]&&"loading"!==O[e]){if(o=O[e],o.width=t.size.x/100*c.width,o.height=t.size.y/100*c.height,s.effects&&s.effects.shadow){const e=s.effects.shadow.color;b.shadowColor="rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")",s.effects.shadow.blur&&(b.shadowBlur=s.effects.shadow.blur)}b.drawImage(o,t.pos.x/100*c.width,t.pos.y/100*c.height,o.width,o.height)}else O[e]||(o=new Image(t.size.x/100*c.width,t.size.y/100*c.height),O[e]="loading",o.onload=()=>{if(O[e]=o,s.effects&&s.effects.shadow){const e=s.effects.shadow.color;b.shadowColor="rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")",s.effects.shadow.blur&&(b.shadowBlur=s.effects.shadow.blur)}b.drawImage(o,t.pos.x/100*c.width,t.pos.y/100*c.height,o.width,o.height)},T[e]&&(o.src=T[e].data))}}o+=n,b.shadowColor=null,b.shadowBlur=0,b.lineWidth=0,b.strokeStyle=null,b.globalAlpha=1}t.forEach((e=>{u[e].stop()}))}const q=()=>{v=s.getGamepads()};function G(){if(E){if(m&&S.push({start:Date.now()}),Object.keys(A).filter((e=>A[e])).forEach((e=>Y(e))),v&&v.length&&v.forEach((e=>{D(s.getGamepadState(e.index))})),g){const e=z(g[0],g[1]);C&&!P&&(H(e),P=setTimeout((()=>{P=null}),30)),e.isClickable||e.action?c.style.cursor="pointer":c.style.cursor="initial",g=null}if(f&&f.length>1&&3==f[0]&&k(f),m){const e=S[S.length-1];e.end=Date.now(),e.end,e.start,S.length%60==0&&U()}window.requestAnimationFrame(G)}}window.addEventListener("gamepadconnected",q),window.addEventListener("gamepaddisconnected",q);let B=[];const U=()=>{const e=S.length-60,t=S.length-1;let o=0;for(let n=e;n<=t;n++)o+=S[n].end-S[n].start;const n=o/60,s=S[t].end-S[e].start;B.push({avgRenderTime:n,lastNFrames:s});const i=(e,t,o,n)=>{const s=e.height,i=5+o/100*e.width,r=n/100*s;t.fillRect(i,r,5,5)},r=avgGraph.getContext("2d",{alpha:!1}),a=lastNGraph.getContext("2d",{alpha:!1});r.clearRect(0,0,avgGraph.width,avgGraph.height),a.clearRect(0,0,lastNGraph.width,lastNGraph.height),r.fillStyle="rgba(226, 114, 91, 255)",a.fillStyle="rgba(255, 192, 203, 255)",r.fillRect(0,0,avgGraph.width,avgGraph.height),a.fillRect(0,0,lastNGraph.width,lastNGraph.height),r.fillStyle="rgba(255, 0, 0, 255)",a.fillStyle="rgba(0, 255, 0, 255)",B.length>10&&(B=B.slice(B.length-10,B.length)),avgGraphLabel.innerHTML=n.toFixed(2)+" ms/render",lastNGraphLabel.innerHTML=Math.floor(1e3/(s/60))+" fps";for(let e=0;e<B.length;e++){const t=1e3/(B[e].lastNFrames/60);i(avgGraph,r,10*e,100-10*B[e].avgRenderTime),i(lastNGraph,a,10*e,100-t)}},H=function(e={}){if(!g)return;const t=g[0],o=g[1],n=(t-c.offsetLeft)/y*100,s=o/clientHeight*100;if(e.action){if("text"===e.action){C=!1;const t=prompt("Input text");d.postMessage(JSON.stringify({type:"input",input:t,nodeId:e.nodeId}))}else if("file"===e.action){C=!1;const t=document.getElementById("file-input");t.click(),t.onchange=o=>{if(t.files.length>0){const o=new FileReader;o.onload=t=>{d.postMessage(JSON.stringify({type:"input",input:new Uint8Array(o.result),nodeId:e.nodeId}))},o.readAsArrayBuffer(t.files[0])}}}}else if(n<=100&&s<=100){const e={type:"click",data:{x:n,y:s}};d.postMessage(JSON.stringify(e))}},D=e=>{d.postMessage(JSON.stringify({type:"input",gamepad:!0,input:e}))},Y=function(e){const t={type:"keydown",key:e};d.postMessage(JSON.stringify(t))},F=()=>{if(!I){I=new(window.AudioContext||window.webkitAudioContext),"suspended"===I.state&&I.resume();for(const e in T)"audio"!==T[e].type||T[e].decoded||I.decodeAudioData(T[e].data,(t=>{T[e].data=t,T[e].decoded=!0}))}};document.addEventListener("touchstart",F,!1);const z=(e,t)=>{let o=!1,n=null,s=null;if(e<c.offsetLeft-window.scrollLeft)return!1;const i=e-c.offsetLeft-window.scrollX,a=t-window.scrollY,l=100*i/y,h=100*a/clientHeight,d=r.y/2,u=100-r.y/2,f=r.x/2,p=100-r.x/2;if(w&&l>f&&l<p&&h>d&&h<u)return!1;for(const i in $){const r=$[i];let a=r[3];if(!a||!a.length)continue;if(!a[0].length){let e=new Array(a.length/2);for(let t=0;t<a.length;t+=2)e[t/2]=[a[t],a[t+1]];a=e}let l=!1,h=K(a[0][0]),d=K(a[0][0]),c=j(a[0][1]),u=j(a[0][1]);for(let e=1;e<a.length;e++){const t=a[e];h=Math.min(K(t[0]),h),d=Math.max(K(t[0]),d),c=Math.min(j(t[1]),c),u=Math.max(j(t[1]),u)}if(!(e<h||e>d||t<c||t>u)){let o=0,n=a.length-1;for(;o<a.length;n=o++)j(a[o][1])>t!=j(a[n][1])>t&&e<(K(a[n][0])-K(a[o][0]))*(t-j(a[o][1]))/(j(a[n][1])-j(a[o][1]))+K(a[o][0])&&(l=!l)}l&&(o=r[0],n=r[1],s=r[2])}return{isClickable:o,action:n,nodeId:s}},K=e=>e*y/100+c.offsetLeft+window.scrollX,j=e=>e*clientHeight/100+c.offsetTop+window.scrollY;function W(e){return 1==e.key.length&&e.key>=" "&&e.key<="z"||e.keyCode>=36&&e.keyCode<=40||"Meta"===e.key||"Backspace"==e.key}window.addEventListener("mousedown",(function(e){C=!0,g=[e.clientX,e.clientY],F()})),window.addEventListener("mouseup",(function(e){C=!1})),c.addEventListener("mousemove",(function(e){})),window.addEventListener("touchstart",(function(e){e.preventDefault(),C=!0,g=[e.touches[0].clientX+window.scrollX,e.touches[0].clientY+window.scrollY]})),c.addEventListener("touchmove",(function(e){e.preventDefault(),C=!0,g=[e.touches[0].clientX+window.scrollX,e.touches[0].clientY+window.scrollY]})),window.addEventListener("touchend",(()=>{C=!1})),/Android/i.test(navigator.userAgent)||(document.addEventListener("keydown",(function(e){W(e)&&!A.Meta&&(e.preventDefault(),Y(e.key),A[e.key]=!0)})),document.addEventListener("keyup",(function(e){W(e)&&(e.preventDefault(),function(e){const t={type:"keyup",key:e};d.postMessage(JSON.stringify(t))}(e.key),A[e.key]=!1)}))),window.addEventListener("mousemove",(e=>{g=[e.clientX+window.scrollX,e.clientY+window.scrollY]})),window.addEventListener("resize",(()=>{R(window.gameWidth,window.gameHeight),f&&f.length>1&&3==f[0]&&k(f),sendClientInfo()}))},115:()=>{},386:()=>{},807:()=>{},993:()=>{},737:()=>{},284:()=>{}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.c=t,o(o.s=672)})();